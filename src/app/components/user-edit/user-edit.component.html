<div mat-dialog-content>
  <h2>Editar Usuario</h2>
  <form [formGroup]="userForm" (ngSubmit)="onSubmit()">
    <div class="form-group mb-3">
      <label for="username">Nombre de usuario</label>
      <input 
        type="text" 
        id="username"
        formControlName="username" 
        class="form-control" 
        [ngClass]="{ 'is-invalid': submitted && f['username'].errors }"
      >
      <div *ngIf="submitted && f['username'].errors" class="invalid-feedback">
        <div *ngIf="f['username'].errors['required']">El nombre de usuario es obligatorio</div>
      </div>
    </div>

    <div class="form-group mb-3">
      <label for="email">Email</label>
      <input 
        type="email" 
        id="email"
        formControlName="email" 
        class="form-control" 
        [ngClass]="{ 'is-invalid': submitted && f['email'].errors }"
      >
      <div *ngIf="submitted && f['email'].errors" class="invalid-feedback">
        <div *ngIf="f['email'].errors['required']">El email es obligatorio</div>
        <div *ngIf="f['email'].errors['email']">El email debe ser válido</div>
      </div>
    </div>

    <div class="form-group mb-3">
      <label for="bio">Biografía</label>
      <textarea 
        id="bio"
        formControlName="bio" 
        class="form-control"
        rows="3"
      ></textarea>
    </div>

    <div class="form-group mb-3">
      <label for="level">Nivel</label>
      <input 
        type="number" 
        id="level"
        formControlName="level" 
        class="form-control" 
        [ngClass]="{ 'is-invalid': submitted && f['level'].errors }"
      >
      <div *ngIf="submitted && f['level'].errors" class="invalid-feedback">
        <div *ngIf="f['level'].errors['required']">El nivel es obligatorio</div>
        <div *ngIf="f['level'].errors['min']">El nivel debe ser al menos 1</div>
      </div>
    </div>

    <div class="form-group mb-3" *ngIf="error">
      <div class="alert alert-danger">{{ error }}</div>
    </div>

  </form>
  <div mat-dialog-actions>
    <button type="button" class="btn btn-secondary me-2" (click)="onCancel()">
      Cancelar
    </button>
    <button type="submit" class="btn btn-primary" [disabled]="loading">
      {{ loading ? 'Guardando...' : 'Guardar cambios' }}
    </button>
  </div>
</div>